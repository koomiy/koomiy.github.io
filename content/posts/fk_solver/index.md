---
title: "005 - 人型ロボットの順運動学"
date: 2023-07-06
categories: ["vnoidベースの開発"]
menu: main
---

---

## 今回の内容

本チャレンジでは、初心者の方でも簡単に人形ロボットの運動計画ができるように、  
vnoidというサンプルパッケージが用意されております。

今回はvnoidパッケージの機能の一つ、  
順運動学ソルバーについて解説します。

---

## 順運動学とは
順運動学とは、ロボットにある関節変位(回転・並進どちらでも可)を与えたときの  
先端効果器の位置・姿勢を求める問題のことです。

複数リンクからなるロボットの動きは一見複雑に思えますが、  
関節変位が決定されれば、全リンクの位置・姿勢が一意に決まります。

人型ロボットの腰リンク(以降ベースリンクと呼びます)の中心に基準座標 $\Sigma_0$ を置きます。  
基準座標系$\Sigma_0$から見た各リンク座標系 $\Sigma_i$ の位置・姿勢を計算することが目標です。

(画像: 基準座標系から肩の座標系の位置・姿勢を求めようとしていることが分かる図)

目標達成のため、ある座標系 $\Sigma_a$ から別の座標系 $\Sigma_b$ を定義する  
一般的な方法について考えてみましょう。

$\Sigma_a$に対する$\Sigma_b$の位置に関しては、  
並進方向の位置の差$\boldsymbol{{}^ap_b}$によって表現できます。

次に、$\Sigma_a$に対する$\Sigma_b$の姿勢の表現方法について考えてみましょう。  
そのために、$\Sigma_b$ から見て常に同じ場所に位置する点$E$について考えてみます。  
つまり、$\boldsymbol{{}^bp_E}$は固定ベクトルです。

$\Sigma_a$ から見た点$E$ $\boldsymbol{{}^ap_E}$ は、  
$\Sigma_b$ の回転に伴って位置が変わったように見えます。  
よって、$\boldsymbol{{}^ap_E}$ を、$\Sigma_a$から見た$\Sigma_b$の回転で表現できれば、  
$\Sigma_a$に対する$\Sigma_b$の姿勢をうまく表現できていることになります。

$\Sigma_a$ の各軸周りに $\Sigma_b$ がどれだけ回転しているかを考えます。  
一般にロール・ピッチ・ヨー方向に回転しているとして、  
各軸周りの回転を、回転行列 $\boldsymbol{{}^aR_b}$ で定義します。  
回転行列をかければベクトルは指定したロール・ピッチ・ヨー回転をしますので、  
以下図のような構図が見えてきます。  
(画像: 座標系と点Eの構図が分かる図)
よって、$\boldsymbol{{}^ap_E}$を次の式で与えられます。  
$$ \boldsymbol{{}^ap_E} = \boldsymbol{{}^ap_b} + \boldsymbol{{}^aR_b} \boldsymbol{{}^bp_E} $$  

以上のことから、$\Sigma_a$から見た$\Sigma_b$の位置・姿勢は、  
$\boldsymbol{{}^ap_b}$と$\boldsymbol{{}^aR_b}$によって表現できることが分かります。

ロボットの関節変位は $q_i$ で表され、  
デフォルトのvnoidでは、回転変位のみ扱えます。

関節変位をリストで並べた関節変位ベクトルを、  
$\boldsymbol{q} = [q_1, q_2, ..., q_n]^T$ により定義します。

---

## サンプルコードの解説



---

## 例題

趣向を凝らして、とあるインド映画のワンショットを再現してみましょう。


---

## まとめ・次回予告

今回はvnoidパッケージの順運動学ソルバーについて解説しました。

次回：歩行ステップ計画
